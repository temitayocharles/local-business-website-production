<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin | Shannon’s Tap + Grill</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>body{font-family:'Inter',sans-serif} h1,h2,h3{font-family:'Playfair Display',serif}</style>
</head>
<body class="bg-[#f8f4ed] text-slate-900">
  <main class="max-w-4xl mx-auto px-6 py-10">
    <h1 class="text-4xl font-semibold">Admin — Shannon’s Tap + Grill</h1>
    <p class="mt-2 text-slate-600">Owner access only. Enter your token to continue.</p>

    <section id="authGate" class="mt-6 bg-white rounded-2xl p-6 shadow">
      <label class="text-sm font-semibold">Owner Token</label>
      <input id="adminToken" class="mt-2 border rounded px-3 py-2 w-full" placeholder="Enter token" />
      <button id="unlock" class="mt-4 px-4 py-2 bg-slate-900 text-white rounded">Unlock</button>
    </section>

    <section id="adminPanel" class="hidden">
      <section class="mt-8 bg-white rounded-2xl p-6 shadow">
        <h2 class="text-2xl font-semibold">Announcement Banner</h2>
        <div class="mt-4 grid gap-4">
          <label class="text-sm font-semibold">Banner Text</label>
          <input id="bannerText" class="border rounded px-3 py-2" placeholder="e.g., Live music Friday at 7 PM" />
          <label class="text-sm font-semibold">Show Banner</label>
          <select id="bannerEnabled" class="border rounded px-3 py-2">
            <option value="true">Yes</option>
            <option value="false">No</option>
          </select>
        </div>
      </section>

      <section class="mt-8 bg-white rounded-2xl p-6 shadow">
        <h2 class="text-2xl font-semibold">Booking Links</h2>
        <p class="text-sm text-slate-600">Add your reservation links. Leave blank to hide a button.</p>
        <div class="mt-4 grid gap-3">
          <input id="linkOpenTable" class="border rounded px-3 py-2" placeholder="OpenTable URL" />
          <input id="linkResy" class="border rounded px-3 py-2" placeholder="Resy URL" />
          <input id="linkTock" class="border rounded px-3 py-2" placeholder="Tock URL" />
          <input id="linkGoogle" class="border rounded px-3 py-2" placeholder="Google Reserve URL" />
          <input id="linkSquare" class="border rounded px-3 py-2" placeholder="Square Appointments URL" />
        </div>
      </section>

      <section class="mt-8 bg-white rounded-2xl p-6 shadow">
        <h2 class="text-2xl font-semibold">Menu Highlights</h2>
        <div id="menuList" class="mt-4 grid gap-2"></div>
        <button id="addMenuItem" class="mt-4 px-4 py-2 bg-slate-900 text-white rounded">Add Item</button>
      </section>

      <button id="saveAll" class="mt-8 px-6 py-3 bg-emerald-700 text-white rounded-lg">Save Changes</button>
    </section>
  </main>

  <script>
    const OWNER_TOKEN = "shannons-owner-2026";
    const storageKey = "shannon-s-tap-grill:siteAdminConfig";
    const tokenKey = "shannon-s-tap-grill:siteAdminToken";

    function requireToken() {
      const saved = localStorage.getItem(tokenKey);
      if (saved === OWNER_TOKEN) {
        document.getElementById('authGate').classList.add('hidden');
        document.getElementById('adminPanel').classList.remove('hidden');
        return true;
      }
      return false;
    }

    document.getElementById('unlock').addEventListener('click', () => {
      const input = document.getElementById('adminToken').value;
      if (input === OWNER_TOKEN) {
        localStorage.setItem(tokenKey, input);
        requireToken();
      } else {
        alert('Invalid token.');
      }
    });

    if (requireToken()) {
      // continue
    }

    function loadConfig(){
      const raw = localStorage.getItem(storageKey);
      if(raw){
        try { return JSON.parse(raw); } catch(e){}
      }
      return {
        bannerText: '',
        bannerEnabled: true,
        booking: { opentable:'', resy:'', tock:'', google:'', square:'' },
        menuItems: []
      };
    }

    function saveConfig(cfg){
      localStorage.setItem(storageKey, JSON.stringify(cfg));
    }

    function renderMenuItems(items){
      const list = document.getElementById('menuList');
      list.innerHTML = '';
      items.forEach((item, idx) => {
        const row = document.createElement('div');
        row.className = 'grid grid-cols-1 md:grid-cols-3 gap-2';
        row.innerHTML = `
          <input class="border rounded px-3 py-2" placeholder="Item name" value="${item.name || ''}" data-idx="${idx}" data-field="name" />
          <input class="border rounded px-3 py-2" placeholder="Short description" value="${item.desc || ''}" data-idx="${idx}" data-field="desc" />
          <input class="border rounded px-3 py-2" placeholder="Price (optional)" value="${item.price || ''}" data-idx="${idx}" data-field="price" />
        `;
        list.appendChild(row);
      });
    }

    const cfg = loadConfig();
    document.getElementById('bannerText').value = cfg.bannerText || '';
    document.getElementById('bannerEnabled').value = String(cfg.bannerEnabled);
    document.getElementById('linkOpenTable').value = cfg.booking?.opentable || '';
    document.getElementById('linkResy').value = cfg.booking?.resy || '';
    document.getElementById('linkTock').value = cfg.booking?.tock || '';
    document.getElementById('linkGoogle').value = cfg.booking?.google || '';
    document.getElementById('linkSquare').value = cfg.booking?.square || '';
    renderMenuItems(cfg.menuItems || []);

    document.getElementById('addMenuItem').addEventListener('click', () => {
      cfg.menuItems = cfg.menuItems || [];
      cfg.menuItems.push({ name:'', desc:'', price:'' });
      renderMenuItems(cfg.menuItems);
    });

    document.getElementById('menuList').addEventListener('input', (e) => {
      const idx = e.target.dataset.idx;
      const field = e.target.dataset.field;
      if(idx === undefined) return;
      cfg.menuItems[idx][field] = e.target.value;
    });

    document.getElementById('saveAll').addEventListener('click', () => {
      cfg.bannerText = document.getElementById('bannerText').value;
      cfg.bannerEnabled = document.getElementById('bannerEnabled').value === 'true';
      cfg.booking = {
        opentable: document.getElementById('linkOpenTable').value,
        resy: document.getElementById('linkResy').value,
        tock: document.getElementById('linkTock').value,
        google: document.getElementById('linkGoogle').value,
        square: document.getElementById('linkSquare').value,
      };
      saveConfig(cfg);
      alert('Saved! Refresh the site to see updates.');
    });
  </script>
</body>
</html>